d = read.table("rattumor.txt", header=TRUE)
head(d)
summary(d)
require(rjags)
require(rjags)
model {
m<- jags.model("rattumor1.bug", d)
m<- jags.model("rattumor1.bug", d)
m
summary(m)
update(m, 2500)
# Then run it for many more iterations, storing samples from selected nodes
x <- coda.samples(m, c("alpha", "beta"), n.iter=10000)
head(x)
m<- jags.model("rattumor1.bug", d)
# First run it for many iteartions until it becomes reliable
update(m, 2500) # burn-in
# Then run it for many more iterations, storing samples from selected nodes
x <- coda.samples(m, c("alpha", "beta"), n.iter=10000)
head(x)
require(rjags)
m<- jags.model("rattumor1.bug", d)
# First run it for many iteartions until it becomes reliable
update(m, 2500) # burn-in
# Then run it for many more iterations, storing samples from selected nodes
x <- coda.samples(m, c("alpha", "beta"), n.iter=10000)
head(x)
x$class
head(x)
head(as.matrix(x))
dim(as.matrix(x))
head
head(as.matrix(x))
summary(x)
require(lattice)
densityplot(x)
alpha =as.matrix(x)[,"alpha"]
beta =as.matrix(x)[,"beta"]
plot(alpha, beta, pch=".", cex=2)
plot(log(alpha/beta), log(alpha+beta), pch=".", cex=2)
d = read.table("rattumor.txt", header=TRUE)
require(rjags)
m<- jags.model("rattumor2.bug", d)
d = read.table("rattumor.txt", header=TRUE)
require(rjags)
m<- jags.model("rattumor2.bug", d)
set.factor("bugs::BinomSlice", "sampler", FALSE)
set.factory("bugs::BinomSlice", "sampler", FALSE)
m<- jags.model("rattumor2.bug", d)
update(m, 2500)
x <- coda.samples(m, c("alpha", "beta"), n.iter=10000)
alpha <- as.matrix(x)[,"alpha"]
beta <- as.matrix(x)[,"beta"]
plot(log(alpha/beta), log(alpha+beta), pch=".", cex=20)
alpha <- as.matrix(x)[,"alpha"]
beta <- as.matrix(x)[,"beta"]
plot(log(alpha/beta), log(alpha+beta), pch=".", cex=2)
library(MASS)
contour(kde2d(log(alpha/beta), log(alpha+beta)))
thetatilde <- rbeta(10000, alpha, beta)
thetatilde <- rbeta(10000, alpha, beta)
with(d, hist(y/N), freq=FALSE, main="", xlim=c(0,1) )
hist(thetatilde, freq=FALSE, density=10, col="blue",border="blue", add=TRUE)
d = read.table("rattumor.txt", header=TRUE)
require(rjags)
m<- jags.model("rattumor2.bug", d)
update(m, 2500)
x <- coda.samples(m, c("alpha", "beta"), n.iter=10000)
set.factory("bugs::BinomSlice", "sampler", FALSE)
m<- jags.model("rattumor2.bug", d)
update(m, 2500)
x <- coda.samples(m, c("alpha", "beta"), n.iter=10000)
alpha <- as.matrix(x)[,"alpha"]
beta <- as.matrix(x)[,"beta"]
plot(log(alpha/beta), log(alpha+beta), pch=".", cex=2)
library(MASS)
contour(kde2d(log(alpha/beta), log(alpha+beta)))
thetatilde <- rbeta(10000, alpha, beta)
with(d, hist(y/N), freq=FALSE, main="", xlim=c(0,1) )
hist(thetatilde, freq=FALSE, density=10, col="blue",border="blue", add=TRUE)
1−(0.50·0.91 + 0.50·0.97)
1-(0.50*0.91 + 0.50*0.97)
0.93/0.99
44/(44+8)
sd(rbeta(100, 44, 8))
sd(rbeta(1000, 44, 8))
(44-1)/(44+8-2)
a= 54
b = 12
a*b/((a+b)^2)*(a+b+1)
a*b/(((a+b)^2)*(a+b+1))
